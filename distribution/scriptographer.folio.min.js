/**!
 *
 *	folio.js
 *	0.6.1
 *	https://github.com/frederickk/folio.js
 *
 *	15. December 2013
 *
 *	Ken Frederick
 *	ken.frederick@gmx.de
 *
 *	http://kennethfrederick.de/
 *	http://blog.kennethfrederick.de/
 *
 *
 *	Folio.js is a library for Paper.js/Scriptographer
 *	Folio.js serves as a collection of functions for supporting animations,
 *	rudimentary 3D, additional Path items and lastly a structured
 *	framework/chain of operations similar to that of Processing,
 *	OpenFrameworks, Cinder, et. al.
 *
 *	Not all of the code in here was created by me
 *	but credit and links are given where credit is due
 *
 *	Additional information and demos can be found here
 *	http://kennethfrederick.de/folio.js/
 *	http://kenfrederick.blogspot.de/2012/12/frederickkpaper.html
 *
 *
 *	This library is free software; you can redistribute it and/or
 *	modify it under the terms of the GNU Lesser General Public
 *	License as published by the Free Software Foundation; either
 *	version 2.1 of the License, or (at your option) any later version.
 *
 *	http://creativecommons.org/licenses/LGPL/2.1/
 *
 *	This library is distributed in the hope that it will be useful,
 *	but WITHOUT ANY WARRANTY; without even the implied warranty of
 *	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	See the GNU
 *	Lesser General Public License for more details.
 *
 *	You should have received a copy of the GNU Lesser General Public
 *	License along with this library; if not, write to the Free Software
 *	Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA	02110-1301	USA
 *
 */

var view=artboard=activeDocument.activeArtboard,raster,paper=PaperScope=global;script.coordinateSystem="top-down",script.angleUnits="degrees",global.inject({enumerable:!0,EPSILON:1e-6,FRAMERATE:12,_event:{count:0,time:0,delta:0},println:function(a){console.log(a),console.log("\n")},Animate:function(a,b){b=void 0===b?FRAMERATE:b;var c=parseInt(1e3*(1/b));a&&setInterval(function(){onFrame(c,Update)},c)},onFrame:function(a,b){a=void 0===a?2:a,_event.count++,_event.time+=.001*a,_event.delta-=_event.time,void 0!=b&&b(_event),_event.delta=_event.time}});var folio=folio||{};folio={FTime:{},FIO:{},F3D:{}},PaperScope.inject({enumerable:!0,println:function(a){console.log(a),console.log("\n")},boolToInt:function(a){return a?1:0},numToBool:function(a){return 0!=a?!0:!1},getType:function(a){return"object"==typeof a?a instanceof paper.Point?"Point":a instanceof paper.Size?"Size":a instanceof paper.Rectangle?"Rectangle":a instanceof Group?"Group":a instanceof paper.PlacedItem?"PlacedItem":a instanceof paper.Raster?"Raster":a instanceof paper.PlacedSymbol?"PlacedSymbol":a instanceof paper.Path?"Path":a instanceof paper.CompoundPath?"CompoundPath":a instanceof paper.Symbol?"Symbol":a instanceof paper.TextItem?"TextItem":"undefined":typeof a},findByName:function(a,b){for(var c,d=0;d<a.length;d++){var e=a[d];e.name==b&&(c=e)}return c},findById:function(a,b){for(var c,d=0;d<a.length;d++){var e=a[d];e.id==b&&(c=e)}return c}}),Array.prototype.median=function(){var a=0;return this.sort(),a=0===this.length%2?(this[this.length/2-1]+this[this.length/2])/2:this[(this.length-1)/2]},Array.prototype.unique=function(){var a=[];a:for(var b=0,c=this.length;c>b;b++){for(var d=0,e=a.length;e>d;d++)if(a[d]==this[b])continue a;a[a.length]=this[b]}return a},Array.prototype.merge=function(a){var b=this.concat(a);return b.shuffle(),b},Array.prototype.max=function(a,b){a=void 0!=a?a:0,b=void 0!=b?b:this.length;for(var c=this[a],d=a+1;b>d;d++)this[d]>c&&(c=d);return c},Array.prototype.min=function(a,b){a=void 0!=a?a:0,b=void 0!=b?b:this.length;for(var c=this[a],d=a+1;b>d;d++)this[d]<c&&(c=d);return c},Array.prototype.shuffle=function(){for(var a,b,c=this.length;c;a=parseInt(Math.random()*c),b=this[--c],this[c]=this[a],this[a]=b);},Array.prototype.removeDuplicates=function(){return this.reduce(function(a,b){return-1===a.indexOf(b)&&a.push(b),a},[])},Array.prototype.round=function(a){for(var b=Math.pow(10,a),c=0;c<this.length;c++)this[c]=Math.round(this[c]*b)/b;return this};var FSort={alphabetical:function(a,b){return a=a.toLowerCase(),a=a.replace(/ä/g,"a"),a=a.replace(/ö/g,"o"),a=a.replace(/ü/g,"u"),a=a.replace(/ß/g,"s"),b=b.toLowerCase(),b=b.replace(/ä/g,"a"),b=b.replace(/ö/g,"o"),b=b.replace(/ü/g,"u"),b=b.replace(/ß/g,"s"),a==b?0:a>b?1:-1},distanceToCenter:function(a,b){var c=a.distanceToCenter();console.log(c);var d=b.distanceToCenter();console.log(d);var e=0;return c>d?e=-1:d>c&&(e=1),e}};PaperScope.inject({enumerable:!0,random:function(a,b){return void 0==b&&(b=a,a=0),a+Math.random()*(b-a)},randomInt:function(a,b){return parseInt(paper.random(a,b))},randomBias:function(a,b,c){var d=new Array(90,9,4,2.33,1.5,1,.66,.43,.25,.11,.01);c=10*Math.max(0,Math.min(c,1));var e=parseInt(Math.floor(c)),f=d[e];return 10>c&&(f+=(d[e+1]-f)*(c-e)),Math.pow(Math.random(),f)*(b-a)+a},clamp:function(a,b,c){return b>a?b:a>c?c:a},normalize:function(a,b,c){return(a-b)/(c-b)},map:function(a,b,c,d,e){return d+(e-d)*((a-b)/(c-b))},round:function(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c},roundMultiple:function(a,b){return Math.floor(a/b)*b+b},snap:function(a,b,c){var c=c||Math.round;return paper.round(b*c(a/b),2)},interpolate:function(a,b,c){return a+(b-a)*c},divisor:function(a){for(var b=[],c=[],d=Math.floor(Math.sqrt(a)),e=1;d>=e;e++)0==a%e&&(b.push(e),e*e!=a&&c.push(a/e));return c.reverse(),b.concat(c)},degrees:function(a){return a*(180/Math.PI)},radians:function(a){return a*(Math.PI/180)},sec:function(a){return 1/Math.cos(a)},cosec:function(a){return 1/Math.sin(a)},sq:function(a){return a*a},getCommonTangents:function(a,b){var c=b.position.x-a.position.x,d=b.position.y-a.position.y,e=Math.sqrt(a.bounds.size.getArea()),f=Math.sqrt(b.bounds.size.getArea());e/=2,f/=2;var g=a.position.getDistance(b.position);if(!(g<=Math.abs(f-e))){var h=Math.atan2(d,c),i=Math.acos((e-f)/g),j=new Point(a.position.x+e*Math.cos(h+i),a.position.y+e*Math.sin(h+i)),k=new Point(b.position.x+f*Math.cos(h+i),b.position.y+f*Math.sin(h+i)),l=new Point(a.position.x+e*Math.cos(h-i),a.position.y+e*Math.sin(h-i)),m=new Point(b.position.x+f*Math.cos(h-i),b.position.y+f*Math.sin(h-i));return[j,k,m,l]}}}),paper.Color.inject({componentToHex:function(a){var b=a.toString(16);return 1==b.length?"0"+b:b},colorToHex:function(){var a,b,c,d="";try{a=255*this.red,b=255*this.green,c=255*this.blue,d="#"+this.componentToHex(a)+this.componentToHex(b)+this.componentToHex(c)}catch(e){console.log(e)}return d},colorToInt:function(){var a;try{a=this.red,a<<=8,a|=this.green,a<<=8,a|=this.blue}catch(b){console.log(b),a=16777215}return a},integer:function(a){return this.red=255&a>>16,this.green=255&a>>8,this.blue=255&a,this},bytes:function(a,b,c,d){return this.red=a/255,this.green=void 0!=b?b/255:a/255,this.blue=void 0!=c?c/255:a/255,this.alpha=void 0!=d?d/255:1,this},desaturate:function(a){var b=new Color(this);return b.saturation=paper.clamp(this.saturation-this.saturation*a,0,1),b},saturate:function(a){var b=new Color(this);return b.saturation=paper.clamp(this.saturation+this.saturation*a,0,1),b},darken:function(a){var b=new Color(this);return b.lightness=paper.clamp(this.lightness-this.lightness*a,0,1),b},dim:function(a){var b=new Color(this);return b.brightness=paper.clamp(this.brightness-this.brightness*a,0,1),b},lighten:function(a){var b=new Color(this);return b.lightness=paper.clamp(this.lightness+this.lightness*a,0,1),b},brighten:function(a){var b=new Color(this);return b.saturation=paper.clamp(this.saturation-this.saturation*a,0,1),b.brightness=paper.clamp(this.brightness+this.brightness*a,0,1),b},contrast:function(a){var b=new Color(this);return b.lightness<.5?b.darken(a):b.lighten(a)},invert:function(){for(var a=new Color(this),b=0;b<a._components.length;b++)a._components[b]=1-a._components[b];return a},rotate:function(a){var b=new Color(this);return b.hue+=a,b},interpolate:function(a,b,c){var d=new Color(this);if("number"==typeof b)for(var e=a.getComponents(),f=0;f<d._components.length;f++)d._components[f]=paper.interpolate(d._components[f],e[f],b);else for(var g=a.getComponents(),e=b.getComponents(),f=0;f<d._components.length;f++)d._components[f]=paper.interpolate(g[f],e[f],c);return d.setType(this.type),d},random:function(){this._components[0]="hsb"==this.type||"hsl"==this.type?paper.random(this._components[0],360):paper.random(this._components[0],1);for(var a=1;a<this._components.length;a++)this._components[a]=paper.random(this._components[a],1);return this}});var FConversions={PIXEL_TO_MM:.352777778,MM_TO_PIXEL:2.83464567,POINT_TO_MM:this.PIXEL_TO_MM,MM_TO_POINT:this.MM_TO_PIXEL,PIXEL_TO_CM:.0352777778,CM_TO_PIXEL:28.3464567,POINT_TO_CM:this.PIXEL_TO_CM,CM_TO_POINT:this.CM_TO_PIXEL,PIXEL_TO_INCH:.0138888889,INCH_TO_PIXEL:72,POINT_TO_INCH:this.PIXEL_TO_INCH,INCH_TO_POINT:this.INCH_TO_PIXEL,PIXEL_TO_PICA:.0833333333,PICA_TO_PIXEL:12,POINT_TO_PICA:this.PIXEL_TO_PICA,PICA_TO_POINT:this.PICA_TO_PIXEL};paper.Item.inject({snapGrid:function(a){this.position.snapGrid(a)},snapIso:function(a){this.position.snapIso(a)},getDistanceToCenter:function(){return this._position.getDistance(view.bounds.center)},toGroup:function(){return"CompoundPath"==folio.getType(this)?new Group(this.children):this}}),paper.Path.inject({getCentroid:function(){var a=new Point(0,0),b=0,c=0,d=[],e=0;for(e;e<this._segments.length-1;++e)d[0]=this._segments[e].point,d[1]=this._segments[e+1].point,c=d[0].x*d[1].y-d[1].x*d[0].y,b+=c,a.x+=(d[0].x+d[1].x)*c,a.y+=(d[0].y+d[1].y)*c;return d[0]=this._segments[e].point,d[1]=this._segments[0].point,c=d[0].x*d[1].y-d[1].x*d[0].y,b+=c,a.x+=(d[0].x+d[1].x)*c,a.y+=(d[0].y+d[1].y)*c,b*=.5,a.x/=6*b,a.y/=6*b,a},getCircumcenter:function(){function a(a,b,c){return a>=b&&a>=c?a:b>=a&&b>=c?b:c}function b(a,b,c){return b>=a&&c>=a?a:a>=b&&c>=b?b:c}if(3===this._segments.length){var c=this._segments[0].point,d=this._segments[1].point,e=this._segments[2].point,f=d.x-c.x,g=d.y-c.y,h=e.x-c.x,i=e.y-c.y,j=f*(c.x+d.x)+g*(c.y+d.y),k=h*(c.x+e.x)+i*(c.y+e.y),l=2*(f*(e.y-d.y)-g*(e.x-d.x));if(Math.abs(l)<Numerical.EPSILON){var m=b(c.x,d.x,e.x),n=b(c.y,d.y,e.y),o=a(c.x,d.x,e.x),p=a(c.y,d.y,e.y);return Point.create((m+o)/2,(n+p)/2)}var q=(i*j-g*k)/l,r=(f*k-h*j)/l;return Point.create(q,r)}return null},getIncircle:function(){for(var a=Number.MAX_VALUE,b=0;b<this._segments.length;b++){var c=this._segments[b].point;c.getDistance(this.getCentroid())<a&&(a=c.getDistance(this.getCentroid()))}return Path.Circle(this.getCentroid(),a)},statics:new function(){return{FArrow:function(a,b,c){var d=new Path.Line(a,b);c=void 0!=c?c:new Size(.381924*a.getDistance(b),.381924*a.getDistance(b));var e=Math.atan2(a.x-b.x,b.y-a.y),f=[];f[0]=new Path.Line(new Point(0,0),new Point(-c.width,-c.height)),f[1]=new Path.Line(new Point(0,0),new Point(c.width,-c.height));for(var g=0;g<f.length;g++)f[g].rotate(180+paper.degrees(e),new Point(0,0)),f[g].translate(a);var h=new Group([d,f[0],f[1]]);return h.name="arrow",h},FBubble:function(a,b,c,d){var e=new Path;e.name="bubble",c=void 0!=c?c:defaultFBubbleTagSize,b.width<10&&(b.width=10,c=new Size(10,10)),d=void 0!=d?d:"RANDOM",e.add(new Point(0,0));var f=180,g=new Point(b.height/2+Math.cos(paper.radians(f))*b.height,b.height/2+Math.sin(paper.radians(f))*b.height);e.arcTo(g,new Point(0,b.height));var h=paper.randomInt(0,b.width-c.width);e.add(new Point(h,b.height));var i,j;return i="LEFT"==d?h:"CENTER"==d?h+c.width/2:"RIGHT"==d?h+c.width:paper.randomInt(h,h+c.width),j=b.height+c.height,e.add(new Point(i,j)),e.add(new Point(h+c.width,b.height)),e.add(new Point(b.width,b.height)),f=0,g=new Point(b.height/2+Math.cos(paper.radians(f))*(b.height/2),b.height/2+Math.sin(paper.radians(f))*(b.height/2)),e.arcTo(new Point(b.width,0),!1),e.closed=!0,e.position=new Point(a.x,a.y+c.height/2),e},FChain:function(a,b,c,d){var e,f;"Point"==a.type?(e=new Path.Circle(a,b),f=new Path.Circle(c,d)):(e=a,f=b);var g=paper.getCommonTangents(e,f),h=new Path;if(null!=g){h.name="chain",h.add(g[0]),h.add(g[1]),angle=f.position.x>e.position.x?0:f.position.y<e.position.y?-90:f.position.y>e.position.y?90:180;var i=new Point(f.position.x+Math.cos(paper.radians(angle))*(f.bounds.width/2),f.position.y+Math.sin(paper.radians(angle))*(f.bounds.height/2));h.arcTo(i,g[2]),h.add(g[2]),h.add(g[3]),angle=e.position.x>f.position.x?0:e.position.y<f.position.y?-90:e.position.y>f.position.y?90:180;var j=new Point(e.position.x+Math.cos(paper.radians(angle))*(e.bounds.width/2),e.position.y+Math.sin(paper.radians(angle))*(e.bounds.height/2));h.arcTo(j,g[0]),h.closed}return h},FCross:function(a,b,c,d){var e,f;"LINE"==d?(e=new Path.Line(a.x+b.width,a.y-b.height,a.x-b.width,a.y+b.height),e.strokeWidth=c,f=new Path.Line(a.x+b.width,a.y+b.height,a.x-b.width,a.y-b.height),f.strokeWidth=c):"SHARP"==d&&(e=new Path,e.add(new Point(a.x+b.width,a.y-b.height)),e.add(new Point(a.x+b.width,a.y-b.height+c/2)),e.add(new Point(a.x-b.width+c/2,a.y+b.height)),e.add(new Point(a.x-b.width,a.y+b.height)),e.add(new Point(a.x-b.width,a.y+b.height-c/2)),e.add(new Point(a.x+b.width-c/2,a.y-b.height)),e.closed=!0,f=new Path,f.add(new Point(a.x-b.width,a.y-b.height)),f.add(new Point(a.x-b.width+c/2,a.y-b.height)),f.add(new Point(a.x+b.width,a.y+b.height-c/2)),f.add(new Point(a.x+b.width,a.y+b.height)),f.add(new Point(a.x+b.width-c/2,a.y+b.height)),f.add(new Point(a.x-b.width,a.y-b.height+c/2)),f.closed=!0);var g=new Group([e,f]);return g.name="cross",g},FDrop:function(a,b){var c=new Path;return c.name="drop",c.add(new Segment(new Point(-.01,.01),new Point(0,-.0055078),new Point(0,.643042))),c.add(new Segment(new Point(-.65,1.6381104),new Point(0,-.6109619),new Point(0,.3694434))),c.add(new Segment(new Point(0,2.31),new Point(-.3578369,0),new Point(.3578369,0))),c.add(new Segment(new Point(.65,1.6381104),new Point(0,.3694434),new Point(0,-.6109619))),c.add(new Segment(new Point(.01,.01),new Point(0,.643042),new Point(0,-.0055078))),c.add(new Segment(new Point(0,-0),new Point(.0055078,0),new Point(-.0055078,0))),c.closed=!0,c.position=a,"Size"==typeof b?c.scale(b.width,b.height):c.scale(b),c},FTriangle:function(a,b,c){var d=new Path;return d.add(a),d.add(b),d.add(c),d.closed=!0,d.name="triangle",d}}}}),paper.Point.inject({name:null,data:{},snap:function(a,b){b=void 0!=b?b:{grid:!0,isometric:!1},a="Size"==a.type?a:new Size(a,a);var c,d;return optons.isometric===!0?(c=Math.round(this.y/(16*a.height)-this.x/(32*a.width)),d=Math.round(this.y/(16*a.height)+this.x/(16*a.width)),this.x=(d-c)/2*32*a.width,this.y=(d+c)/2*16*a.height):(c=Math.round(this.y/a.height-this.x/a.width),d=Math.round(this.y/a.height+this.x/a.width),this.x=(d-c)/2*a.width,this.y=(d+c)/2*a.height),this},interpolateTo:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},getDistanceToCenter:function(){return this.getDistance(view.bounds.center)},getHeading:function(){return-1*Math.atan2(-this.y,this.x)},getAngle:function(a){return Math.atan2(a.y-this.y,a.x-this.x)},norm:function(a,b){return this.x=paper.normalize(this.x,a.x,b.x),this.y=paper.normalize(this.y,a.y,b.y),this},magSq:function(){return this.x*this.x+this.y*this.y}}),paper.Size.inject({getArea:function(){return this.width*this.height},getCircumarea:function(){var a=this.getCircumradius();return Math.PI*a*a},getIncirclearea:function(){var a=this.getIncircleradius();return Math.PI*a*a},getCircumradius:function(){var a=this.width,b=this.height;return Math.sqrt(a*a+b*b)/2},getIncircleradius:function(){return this.width<this.height?this.width/2:this.height/2},getSlopeAngle:function(){return Math.atan(this.width/this.height)}}),String.prototype.trimEnd=function(){for(var a=this.length-1;" "==this.charAt(a);a--)this.substring(0,a);return this},String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/gi,""),this.replace(/[ ]{2,}/gi," "),this.replace(/\n /,"\n"),this},String.prototype.toBool=function(){switch(this.toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(this)}},paper.TextItem.inject({trimToFit:function(){var a=this.visibleRange.content.trim();return this.content=a,this}}),folio.FTime={FDate:{},FStopwatch:{},FStepper:{},Ease:{}},folio.FTime.Ease=function(){function a(a,b){function c(a,b){return 1-3*b+3*a}function d(a,b){return 3*b-6*a}function e(a){return 3*a}function f(a,b,f){return((c(b,f)*a+d(b,f))*a+e(b))*a}function g(a,b,f){return 3*c(b,f)*a*a+2*d(b,f)*a+e(b)}function h(a){for(var b=a,c=0;4>c;++c){var d=g(b,j[0],j[2]);if(0==d)return b;var e=f(b,j[0],j[2])-a;b-=e/d}return b}function i(a){return j[0]==j[1]&&j[2]==j[3]?a:f(h(a),j[1],j[3])}var j;return a instanceof Array?j=a:(a=a.normalize(),b=b.normalize(),j=[a.x,a.y,b.x,b.y]),{get:i}}return{linear:function(a){return a},inQuad:function(a){return a*a},outQuad:function(a){return a*(2-a)},inOutQuad:function(a){return.5>a?2*a*a:-1+(4-2*a)*a},inCubic:function(a){return a*a*a},outCubic:function(a){return--a*a*a+1},inOutCubic:function(a){return.5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},inQuart:function(a){return a*a*a*a},outQuart:function(a){return 1- --a*a*a*a},inOutQuart:function(a){return.5>a?8*a*a*a*a:1-8*--a*a*a*a},inQuint:function(a){return a*a*a*a*a},outQuint:function(a){return 1+--a*a*a*a*a},inOutQuint:function(a){return.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a},inSine:function(a){return-1*Math.cos(a*(Math.PI/2))+1},outSine:function(a){return 1*Math.sin(a*(Math.PI/2))},inOutSine:function(a){return-.5*(Math.cos(Math.PI*a)-1)},inExpo:function(a){return 1*Math.pow(2,10*(a-1))},outExpo:function(a){return 1*(-Math.pow(2,-10*a)+1)},inOutExpo:function(a){return a/=.5,1>a?.5*Math.pow(2,10*(a-1)):(a--,.5*(-Math.pow(2,-10*a)+2))},inCirc:function(a){return-1*(Math.sqrt(1-a*a)-1)},outCirc:function(a){return a--,1*Math.sqrt(1-a*a)},inOutCirc:function(a){return a/=.5,1>a?-.5*(Math.sqrt(1-a*a)-1):(a-=2,.5*(Math.sqrt(1-a*a)+1))},spline:a}},folio.FTime.FDate=function(){this.date;var a=function(a){return 1==a.length&&(a="0"+a),a};this.year=function(){void 0===this.date&&(this.date=new Date);var a=String(this.date.getFullYear());return a},this.month=function(){void 0===this.date&&(this.date=new Date);var b=String(this.date.getMonth());return hour=a(b),b},this.day=function(){void 0===this.date&&(this.date=new Date);var a=String(this.date.getDate());return a},this.hour=function(){void 0===this.date&&(this.date=new Date);var b=String(this.date.getHours());return b=a(b)},this.minute=function(){void 0===this.date&&(this.date=new Date);var b=String(this.date.getMinutes());return b=a(b)},this.second=function(){void 0===this.date&&(this.date=new Date);var b=String(this.date.getSeconds());return b=a(b)},this.now=function(a){var b=[];b=void 0===a?[!0,!0,!0]:a;var c="";return b[0]&&(c+=this.hour()),b[0]&&b[1]&&(c+=":"),b[1]&&(c+=this.minute()),b[1]&&b[2]&&(c+=":"),b[2]&&(c+=this.second()),c},this.nowMilliseconds=function(){return this.toMillsecond(this.hour(),this.minute(),this.second())},this.add=function(a,b,c){return this.date+(24*a+60*b+60*c+1e3*s)},this.sub=function(a,b,c){return this.date-(24*a+60*b+60*c+1e3*s)},this.set=function(a,b,c){return this.time=new Date,this.time.setTime(24*a+60*b+60*c+1e3*s),this.time},this.get=function(a,b){var c;c=void 0===b?new Array(!0,!0,!0):b;var d,e,f,g=parseInt(a/1e3%60),h=parseInt(a/1e3/60%60),i=parseInt(a/1e3/60/60%24);d=10>i?"0"+i:""+i,e=10>h?"0"+h:""+h,f=10>g?"0"+g:""+g;var j="";return c[0]&&(j+=d),c[0]&&c[1]&&(j+=":"),c[1]&&(j+=e),c[1]&&c[2]&&(j+=":"),c[2]&&(j+=f),j},this.toMillsecond=function(a,b,c){var d,e,f;return void 0===b&&void 0===c?(d=this.toArray(a)[0],e=this.toArray(a)[1],f=this.toArray(a)[2]):(d=a,e=b,f=c),parseInt(36e5*d+6e4*e+1e3*f)},this.toArray=function(a){var b=a.split(":");return[b[0],b[1],b[2]]}},folio.FTime.FStepper=function(){var a=1e3,b=0,c=0,d=0,e=!1,f=!1,g=!1;this.delta=1,this.counter=-1,this.toggle=function(){0==d?(d=1,this.stepOut()):(d=0,this.stepIn())},this.update=function(d){if(e&&(e=!1,b=d,c=f?paper.round(d+(1-this.delta)*a,3):paper.round(d+this.delta*a,3),d>=c&&(f?(f=!1,this.delta=1):(g=!1,this.delta=0))),f){if(this.delta=paper.round(1-(c-d)/a,3),d==c)return f=!1,this.delta=1,this.counter++,void 0}else if(g&&(this.delta=paper.round((c-d)/a,3),d==c))return f=!1,this.delta=0,this.counter++,void 0},this.stepIn=function(){f||1!=this.delta&&(e=!0,f=!0,g=!1)},this.stepOut=function(){g||0!=this.delta&&(e=!0,g=!0,f=!1)},this.isIn=function(){return f},this.isOut=function(){return g},this.isDone=function(){return this.delta<1&&this.delta>0?!1:this.delta>1?(this.delta=1,!0):this.delta<0?(this.delta=0,!0):void 0},this.stop=function(){e=f=g=!1},this.setSeconds=function(a){this.setMillis(parseInt(1e3*a))},this.setMillis=function(b){a=b,a/=1e3},this.setDelta=function(a){this.delta=a}},folio.FTime.FStopwatch=function(){var a,b,c=0,d=0;this.toggle=function(){0==d?this.start():this.pause()},this.start=function(){d=1,b=new Date,b.setTime(b.getTime()-c)},this.pause=function(){d=0,a=new Date,c=a.getTime()-b.getTime()},this.reset=function(){d=0,c=0},this.set=function(a,e){c=a,d=1==e?0:1,b=new Date,b.setTime(b.getTime()-c),this.toggle()},this.get=function(){return 1==d&&(a=new Date,c=a.getTime()-b.getTime()),c},this.isRunning=function(){return d?!0:!1}},folio.FIO={saveLocal:function(a,b){window.localStorage?localStorage.setItem(a,String(b)):console.error("localStorage not supported")},getLocal:function(a){return localStorage.getItem(a)},getLocalInt:function(a){return parseInt(getLocal(a))},getLocalFloat:function(a){return parseFloat(getLocal(a))},getAllLocal:function(){return sessionStorage},deleteLocal:function(a){localStorage.removeItem(a)},saveSession:function(a,b){window.sessionStorage?sessionStorage.setItem(a,String(b)):console.error("sessionStorage not supported")},getSession:function(a){return sessionStorage.getItem(a)},getSessionInt:function(a){return parseInt(getSession(a))},getSessionFloat:function(a){return parseFloat(getSession(a))},getAllSession:function(){return sessionStorage},deleteSession:function(a){sessionStorage.removeItem(a)},saveCookie:function(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+1e3*60*60*24*c);var e="; expires="+d.toGMTString()}else var e="";document.cookie=a+"="+b+e+"; path=/"},openCookie:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return null},deleteCookie:function(a){saveCookie(a,"",-1)},saveFile:function(a,b){var c=new File(script.file.parent,b);c.exists()&&c.remove(),c.open(),c.write(Json.encode(a)),c.close()},openFile:function(a){var b=new File(script.file.parent,a);b.open();var c=Json.decode(b.readAll());return b.close(),c},deleteFile:function(a){var b=new File(script.file.parent,a);b.exists()&&b.remove()},checkFile:function(a){var b=new File(script.file.parent,a);return b.exists()?!0:!1}},folio.FCirclePacker=function(a,b){a=a,b=void 0!=b?b:11;var c=.1,d=0,e=function(){a=a.sort(folio.distanceToCenter);for(var e=new Point,f=a.length-1;f>=0;--f)for(var g=a[f],h=g.position,i=f+1;i<a.length;i++){var j=a[i],k=j.position;if(f!=i){var l=k.x-h.x,m=k.y-h.y,n=g.bounds.size.width/2+j.bounds.size.width/2+d,o=l*l+m*m;if(n*n-.01>o){e.x=l,e.y=m,e=e.normalize(1),e=e.multiply(.5*(n-Math.sqrt(o)));try{k.x+=e.x,k.y+=e.y,h.x-=e.x,h.y-=e.y}catch(p){a.slice(i,1);break}}}}for(var q=c/Number(b),f=0;f<a.length;f++){var r=a[f],s=r.position;e.x=s.x-artboard.bounds.center.x,e.y=s.y-artboard.bounds.center.y,e=e.multiply(q),s.x-=e.x,s.y-=e.y}},f=function(b){"array"==typeof b?a=a.concat(b):a.push(b)},g=function(a){c=a},h=function(a){d=a},i=function(){return a},j=function(b){return a[b]};return{update:e,add:f,setDamping:g,setPadding:h,getItems:i,getItem:j}},folio.FRoute=function(a,b){function c(){var c,f;if(0==d){for(var g=0,h=new Array(a.length),i=0;i<a.length;++i){h[i]=!1;var j=a[i].position.x,k=a[i].position.y;j>=view.bounds.width||k>=view.bounds.height||0>j||0>k||(h[i]=!0,g++)}e=new Array(g);for(var l=0,i=0;i<a.length;++i)h[i]&&(e[l]=i,l++)}var m=e.length-1;if(d<e.length-2){var n=d+1e3;n>m&&(n=m);for(var i=d;n>i;++i){f=a[e[d]].position;for(var o=0,p=Number.MAX_VALUE,q=d+1;m>q;++q){var r=a[e[q]].position,s=f.x-r.x,t=f.y-r.y,u=s*s+t*t;p>u&&(o=q,p=u)}c=e[d+1],e[d+1]=e[o],e[o]=c,m>d?d++:console.log("Now optimizing plot path")}}for(var i=0;b>i;++i){var v=Math.floor(Math.random()*m),w=Math.floor(Math.random()*m);if(!(Math.abs(v-w)<2)){v>w&&(c=w,w=v,v=c);var x=a[e[v]].position,y=a[e[v+1]].position,z=a[e[w]].position,A=a[e[w+1]].position,s=x.x-y.x,t=x.y-y.y,u=s*s+t*t;s=z.x-A.x,t=z.y-A.y,u+=s*s+t*t,s=x.x-z.x,t=x.y-z.y;var B=s*s+t*t;if(s=y.x-A.x,t=y.y-A.y,B+=s*s+t*t,u>B)for(var C=w,D=v+1;C>D;)c=e[D],e[D]=e[C],e[C]=c,C--,D++}}}var a=a,b=void 0!=b?b:1e3,d=0,e=[];return c(),{route:e}};var EPSILON=1e-6;folio.FTriangulate=function(a){function b(){if(k=[],null!=l.length){l=f(l),l.sort(e);var a=l[0].x,b=l[0].y,d=a,h=b;l[0].z;for(var i=0;i<l.length;i++){var j=l[i];j.x<a&&(a=j.x),j.x>d&&(d=j.x),j.y<b&&(b=j.y),j.y>h&&(h=j.y)}var p=d-a,q=h-b,r=p>q?p:q,s=(d+a)/2,t=(h+b)/2;k=[];var u=new HashSet,v=new n(new Point(s-2*r,t-r),new Point(s,t+2*r),new Point(s+2*r,t-r));k.push(v);for(var w=[],i=0;i<l.length;i++){var j=l[i];w=[];for(var x=new Point,y=k.length-1;y>=0;y--){var z=k[y];if(!u.contains(z)){var A=c(j,z,x);x.x+x.z<j.x&&u.add(z),A&&(w.push(new o(z.p1,z.p2)),w.push(new o(z.p2,z.p3)),w.push(new o(z.p3,z.p1)),k.splice(y,1))}}w=g(w);for(var y=0;y<w.length-1;y++)for(var B=w[y],C=y+1;C<w.length;C++){var D=w[C];B.p1==D.p2&&B.p2==D.p1&&(B.p1=null,B.p2=null,D.p1=null,D.p2=null),B.p1==D.p1&&B.p2==D.p2&&(B.p1=null,B.p2=null,D.p1=null,D.p2=null)}for(var y=0;y<w.length;y++){var E=w[y];if(null!=E.p1&&null!=E.p2){for(var C=0;C<m.length;C++)E.p1.name=E.p1==m[C]?"__new":null,E.p2.name=E.p2==m[C]?"__new":null,j.name=j==m[C]?"__new":null;k.push(new n(E.p1,E.p2,j))}}}for(var i=k.length-1;i>=0;i--){var z=k[i];z.sharesVertex(v)&&k.splice(i,1)}}}function c(a,b,c){var d,e,f,g,h,i,j,k,l,m;return Math.abs(b.p1.y-b.p2.y)<EPSILON&&Math.abs(b.p2.y-b.p3.y)<EPSILON?!1:(Math.abs(b.p2.y-b.p1.y)<EPSILON?(e=-(b.p3.x-b.p2.x)/(b.p3.y-b.p2.y),g=(b.p2.x+b.p3.x)/2,i=(b.p2.y+b.p3.y)/2,c.x=(b.p2.x+b.p1.x)/2,c.y=e*(c.x-g)+i):Math.abs(b.p3.y-b.p2.y)<EPSILON?(d=-(b.p2.x-b.p1.x)/(b.p2.y-b.p1.y),f=(b.p1.x+b.p2.x)/2,h=(b.p1.y+b.p2.y)/2,c.x=(b.p3.x+b.p2.x)/2,c.y=d*(c.x-f)+h):(d=-(b.p2.x-b.p1.x)/(b.p2.y-b.p1.y),e=-(b.p3.x-b.p2.x)/(b.p3.y-b.p2.y),f=(b.p1.x+b.p2.x)/2,g=(b.p2.x+b.p3.x)/2,h=(b.p1.y+b.p2.y)/2,i=(b.p2.y+b.p3.y)/2,c.x=(d*f-e*g+i-h)/(d-e),c.y=d*(c.x-f)+h),j=b.p2.x-c.x,k=b.p2.y-c.y,l=j*j+k*k,c.z=Math.sqrt(l),j=a.x-c.x,k=a.y-c.y,m=j*j+k*k,l>=m)}function d(a){for(var b,c=0;c<k.length;c++)for(var d=k[c],e=a.getCentroid.getDistance(d.getCentroid),f=0;f<k.length;f++){var g=k[f],h=a.getCentroid.getDistance(g.getCentroid);if(e>h){b=g;break}}return b}function e(a,b){return a.x<b.x?1:a.x>b.x?-1:0}function f(a){a.sort();for(var b=1;b<a.length;)a[b-1].x==a[b].x&&a[b-1].y==a[b].y?a.splice(b,1):b++;return a}function g(a){a.sort();for(var b=1;b<a.length;)a[b-1].p1==a[b].p1&&a[b-1].p2==a[b].p2||a[b-1].p1==a[b].p2&&a[b-1].p2==a[b].p2?a.splice(b,1):b++;return a}function h(a){m=[],a instanceof Array?(m=a,l=l.concat(a)):(m[0]=a,l.push(a)),l=f(l),b()}function i(a){return null!=a?k[a]:k}function j(a){return null!=a?l[a]:l}var k,l=a,m=[],n=function(a,b,c){function d(d){return a==d.p1||a==d.p2||a==d.p3||b==d.p1||b==d.p2||b==d.p3||c==d.p1||c==d.p2||c==d.p3}function e(){return new Point((j.x+k.x+l.x)/3,(j.y+k.y+l.y)/3)}function f(){var a=0;j.x<k.x&&j.x<l.x?a=j.x:k.x<j.x&&k.x<l.x?a=k.x:l.x<j.x&&l.x<k.x&&(a=l.x);var b=0;j.x>k.x&&j.x>l.x?b=j.x:k.x>j.x&&k.x>l.x?b=k.x:l.x>j.x&&l.x>k.x&&(b=l.x);var c=Math.abs(b-a);return c}function g(){var a=0;j.y<k.y&&j.y<l.y?a=j.y:k.y<j.y&&k.y<l.y?a=k.y:l.y<j.y&&l.y<k.y&&(a=l.y);var b=0;j.y>k.y&&j.y>l.y?b=j.y:k.y>j.y&&k.y>l.y?b=k.y:l.y>j.y&&l.y>k.y&&(b=l.y);var c=Math.abs(b-a);return c}function h(){var a=0;return a+=(j.x+l.x)*(l.y-j.y),a+=(k.x+j.x)*(j.y-k.y),a+=(l.x+k.x)*(k.y-l.y),a/2}function i(){var a=[j,k,l];return a}var j=a,k=b,l=c;return{p1:j,p2:k,p3:l,sharesVertex:d,getCentroid:e,getArea:h,getWidth:f,getHeight:g,getPoints:i}},o=function(a,b){function c(){var a=[d,e];return a}var d=a,e=b,f=d.getDistance(e);return{p1:d,p2:e,dist:f,getPoints:c}};return b(),{add:h,getTriangles:i,getPoints:j,getClosest:d}};var HashSet=function(){function a(a){var b=g,c=b.indexOf(a);-1==c&&b.push(a)}function b(a){return g[a]}function c(){return g.length}function d(a){var b=g,c=b.indexOf(a);-1!=c&&b.splice(c,1)}function e(a){for(var b=!1,c=0;c<g.length;c++)g[c]===a&&(b=!0);return b}function f(){return g.join(",")}var g=new Array;return{add:a,get:b,size:c,remove:d,contains:e,toString:f}};