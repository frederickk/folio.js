<!-- 
  -	FrederickkPaper Webapp Template 0.3a
  -
  -	Ken Frederick
  -	ken.frederick@gmx.de
  -
  -	http://cargocollective.com/kenfrederick/
  -	http://kenfrederick.blogspot.com/
  -
  -
  -	This template was created to streamline the creation
  -	of PaperJS sketches for use on the interwebs.
  -	
  -	This template is designed so that there is very little
  -	setup required for using PaperJS within a traditional
  -	JavaScript context.
  -
  -	By using the accompanying scripts/FPaperTemplate.js you can
  -	simply code everything within the FPaperTemplate.js file,
  -	all of the necessary callbacks are already implemented in this HTML
  -
  -	Feel free to rename this file and .js template file
  -
  -->

<!-- DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" -->
<html>
	<head>
		<!-- META -->
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		 
		<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black" />


		<link rel="shortcut icon" type="image/x-icon" href="images/stillen_favicon.ico" />


		<!-- iOS DEVICE ICON -->
 		<link rel="apple-touch-icon-precomposed" href="images/iphone_icon.png" />
		<link rel="apple-touch-icon-precomposed" size="114x114" href="images/iphone_icon@2.png" />

		<!-- iOS DEVICE STARTUP IMAGES -->
		<!-- iPhone/iPod Touch Portrait  -->
		<link rel="apple-touch-startup-image" href="images/iphone_startup.png" media="screen and (max-device-width: 320px)" />
		<link rel="apple-touch-startup-image" href="images/iphone_startup@2.png" media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" />

		<!-- iPad -->
 		<link rel="apple-touch-startup-image" href="images/ipad_startup_landscape.png" sizes="1024x748" media="screen and (min-device-width: 481px) and (max-device-width: 1024px) and (orientation:landscape)" />
		<link rel="apple-touch-startup-image" href="images/ipad_startup_portrait.png" sizes="768x1004" media="screen and (min-device-width: 481px) and (max-device-width: 1024px) and (orientation:portrait)"/>

		<!-- iPad (Retina) -->
 		<link rel="apple-touch-startup-image" href="images/ipad_startup_landscape@2.png" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" />
		<link rel="apple-touch-startup-image" href="images/ipad_startup_portrait@2.png" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" />

		
		<title>frederickkPaper Webapp Template</title>
		
		
		<!-- CSS -->
		<!-- LOAD ADDITIONAL CSS STYLESHEETS -->
		<link href="css/FPaper.css" rel="stylesheet" type="text/css" />

		
		<!-- JavaScript -->
		<!-- LOAD LIBRARIES -->
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>


		<!-- LOAD PAPERJS -->
		<!-- download PaperJS from http://paperjs.org/download/ and update path -->
		<script type="text/javascript" src="path/to/paper.js"></script>
		<script>
			// ------------------------------------------------------------------------
			// Global Properties
			// ------------------------------------------------------------------------
			// global properties
			var ios;
			var device = {
				isiPad: null,
				isiPhone: null,
				isiPod: null,
				isSafari: null,
				isAndroid: null
			};



			// ------------------------------------------------------------------------
			// Global Methods
			// ------------------------------------------------------------------------
			paper.install(window);
			$(document).ready(function(){
				paper.setup('canvas');
				console.log('PaperJS is go!');
				


				// ------------------------------------------------------------------------
				// PaperJS Methods
				// ------------------------------------------------------------------------
				Setup();


				// ------------------------------------------------------------------------
				Draw();

				
				
				// ------------------------------------------------------------------------
				// PaperJS Events
				// ------------------------------------------------------------------------
				view.onFrame = function(event) {
					Update(event);
				};
				
				view.onResize = function(event) {
					onResize(event);
				};

				// ------------------------------------------------------------------------
				var tool = new Tool();
				tool.onMouseUp = function(event) {
					onMouseUp(event);
				};
				
				tool.onMouseDown = function(event) {
					onMouseDown(event);
				};
				
				tool.onMouseMove = function(event) {
					onMouseMove(event);
				};
				
				tool.onMouseDrag = function(event) {
					onMouseDrag(event);
				};


				// ------------------------------------------------------------------------
				tool.onKeyDown = function(event) {
					onKeyDown(event);
				};

				tool.onKeyUp = function(event) {
					onKeyUp(event);
				};
				
				
				// ------------------------------------------------------------------------
				view.draw(); // draw the screen

			});



			/**
			 *
			 *	WebApp Supporting Methods
			 *	
			 *	TODO: tweak orientation settings to procure correct angle
			 *
			 */
			// ------------------------------------------------------------------------
			function orientationChange() {
				console.log( 'orientationChange()' );
				isRotated = true;

				// angle = window.orientation;

				orientation	= 'landscape';
				// if(window.orientation == 90 || window.orientation == -90)	orientation	= 'landscape';
				if(window.orientation == 0 || window.orientation == 180) orientation = 'portrait';

				if (window.orientation == -90) {
					angle = 90;
				}
				if (window.orientation == 90) {
					angle = -90;
				}
				if (window.orientation == 0) {
					angle = 0;
				}
			};

			// ------------------------------------------------------------------------
			function resizeCanvas() {
				var width = $('#container').width();
				var height = $('#container').height();
				
				// set canvas width and height
				$('#canvas').attr('width', width);
				$('#canvas').attr('height', height)

				Draw();
				view.draw(); // draw the screen

			};

			// ------------------------------------------------------------------------
			$(function() {
				angle = 0; // orienation angle
				isRotated = false;

				ios = navigator.userAgent.match(/(iPhone)|(iPod)|(iPad)/);
				device.isiPad    = (navigator.userAgent.match(/iPad/i) != null);
				device.isiPhone  = (navigator.userAgent.match(/iPhone/i) != null);
				device.isiPod    = (navigator.userAgent.match(/iPod/i) != null);
				device.isSafari  = (navigator.userAgent.match(/Safari/i) != null);
				device.isAndroid = (navigator.userAgent.match(/Android/i) != null);



				// ------------------------------------------------------------------------
				// Orientation Change Event Handler
				// ------------------------------------------------------------------------
				var otimeout;
				window.onorientationchange = function() {
					clearTimeout(otimeout);
					otimeout = setTimeout(orientationChange, 50);
				};				
				


				// ------------------------------------------------------------------------
				// Resize Event Handler
				// ------------------------------------------------------------------------
				var resizeTimeout;
				$(window).resize(function() {
					clearTimeout(resizeTimeout);
					resizeTimeout = setTimeout(resizeCanvas, 100);
				});
				resizeCanvas();
				
			});


		</script>


		<!-- LOAD ADDITIONAL JAVASCRIPTS -->
		<!-- https://github.com/frederickk/frederickkPaper -->
		<script type="text/javascript" src="../distribution/frederickkPaper.js"></script>

		<!-- LOAD PAPER SCRIPT -->
		<!-- be sure that the filename and path matches your script -->
		<script type="text/javascript" src="scripts/FPaperTemplate.js"></script>



		<meta http-equiv="x-dns-prefetch-control" content="off"/>
	</head>
	<body>


		<!-- CANVAS -->
		<div id="container">
			<canvas resize="true" id="canvas"></canvas>
		</div>


		<!-- TEXT -->
		<div id="textContainer">
			<!-- any text/description  -->
		</div>

		<div id="manual" class="black">
			<!-- any instructions for controlling the interaction  -->
		</div>


		<!-- INPUTS -->
		<div id="inputLabelContainer">
			<!-- any labels for form elemenst -->
		</div>

		<div id="inputContainer">
			<!-- any form elements which need to be accessed should be placed in here -->
		</div>


		<!-- IMAGES -->
		<div id="rasterImages">
			<!-- any images which need to be accessed should be placed in here -->
			<!-- http://paperjs.org/tutorials/images/working-with-rasters/ -->
		</div>

		
	</body>
</html>
